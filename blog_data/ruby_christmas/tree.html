<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <title>MERRY CHRISTMAS</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="./index.css" />
    <style>
      * {
        box-sizing: border-box;
      }
      html {
        background: black;
      }
      #tree {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 620px;
        margin: 50px auto;
        padding: 50px 20px;
        border: 10px solid red;
      }
      h1 {
        margin: 0 0 80px;
        color: gold;
        font-family: 'Black Han Sans', sans-serif;
      }
      .row {
        display: flex;
        justify-content: center;
      }
      .tri {
        width: 0;
        height: 0;
        border-right: 25px solid transparent;
        border-left: 25px solid transparent;
        border-bottom: 40px solid seagreen;
      }
      #star {
        position: relative;
        display: block;
        width: 0;
        height: 0;
        border-left: 30px solid transparent;
        border-bottom: 20px solid orange;
        border-right: 30px solid transparent;
        color: orange;
        transform: rotate(35deg);
      }
      #star:before {
        content: '';
        position: absolute;
        top: -18px;
        left: -18px;
        display: block;
        width: 0;
        height: 0;
        border-left: 12px solid transparent;
        border-bottom: 38px solid orange;
        border-right: 12px solid transparent;
        transform: rotate(-35deg);
      }
      #star:after {
        content: '';
        position: absolute;
        top: 1px;
        left: -30px;
        display: block;
        width: 0;
        height: 0;
        border-left: 30px solid transparent;
        border-bottom: 20px solid orange;
        border-right: 30px solid transparent;
        color: orange;
        transform: rotate(-70deg);
      }
      #trunk {
        width: 50px;
        height: 80px;
        background: #7d3817;
      }
    </style>
  </head>
  <body>
    <div id="pos" style="z-index:1;position: absolute;left: 0px;top: 0px;"></div>

    <div class="santa-container">
      <svg
        data-name="Layer 1"
        xmlns="http://www.w3.org/2000/svg"
        width="350"
        height="400"
      >
        <path fill="transparent" d="M0 0h350v400H0z" />
        <g class="plane">
          <rect
            x="215.747"
            y="157.738"
            width="25.511"
            height="43.645"
            rx="12.755"
            ry="12.755"
            fill="#711723"
          />
          <path
            fill="#f40009"
            d="M166.263 185.401h74.995v31.965h-74.995zM166.263 217.366h74.995a31.965 31.965 0 01-31.965 31.965h-43.03v-31.965z"
          />
          <g class="hand">
            <rect
              x="136.437"
              y="152.836"
              width="26.365"
              height="9.113"
              rx="4.557"
              ry="4.557"
              transform="rotate(-120 149.62 157.393)"
              fill="#f6bfb1"
            />
            <path
              fill="#f40009"
              d="M144.906 163.746l11.978-6.916 20.407 35.346-11.978 6.916z"
            />
            <rect
              x="139.226"
              y="154.214"
              width="20.172"
              height="6.973"
              rx="3.486"
              ry="3.486"
              transform="rotate(-30 149.312 157.7)"
              fill="#e6e6e6"
            />
          </g>
          <path fill="#f6bfb1" d="M171.488 155.28h37.805v23.974h-37.805z" />
          <path
            d="M165.956 185.093v64.545h-12.602v-.024c-.406.015-.818.024-1.23.024a32.272 32.272 0 110-64.545c.412 0 .824.01 1.23.025v-.025z"
            fill="#711723"
          />
          <path fill="#300403" d="M161.345 185.093h4.918v64.545h-4.918z" />
          <path
            d="M113.376 210.296v11.987h-2.34v-.004a6.053 6.053 0 01-.23.004 5.993 5.993 0 110-11.987c.077 0 .154.002.23.005v-.005z"
            fill="#f40009"
          />
          <g fill="#300403">
            <circle cx="155.505" cy="244.106" r="2.459" />
            <circle cx="155.505" cy="190.933" r="2.459" />
            <circle cx="155.505" cy="208.452" r="2.459" />
            <circle cx="155.505" cy="226.586" r="2.459" />
          </g>
          <rect
            class="blade"
            x="113.244"
            y="167.266"
            width="6.762"
            height="98.354"
            rx="3.381"
            ry="3.381"
            fill="#300403"
          />
          <path
            d="M195.154 211.526h34.732a4.918 4.918 0 014.917 4.918 4.918 4.918 0 01-4.917 4.917h-34.732a4.918 4.918 0 01-4.917-4.917 4.918 4.918 0 014.917-4.918z"
            fill="#711723"
          />
          <g fill="#fff">
            <rect
              x="174.148"
              y="171.282"
              width="15.925"
              height="40.192"
              rx="7.963"
              ry="7.963"
            />
            <rect
              x="188.824"
              y="171.282"
              width="15.925"
              height="40.192"
              rx="7.963"
              ry="7.963"
            />
            <rect
              x="180.862"
              y="167.691"
              width="15.925"
              height="51.21"
              rx="7.963"
              ry="7.963"
              transform="rotate(-90 188.824 193.296)"
            />
            <path
              d="M161.55 180.896a7.963 7.963 0 016.42-9.252l20.066-3.625a7.963 7.963 0 019.251 6.42 7.963 7.963 0 01-6.42 9.251l-20.066 3.626a7.963 7.963 0 01-9.251-6.42z"
            />
            <path
              d="M183.122 174.543a7.963 7.963 0 019.251-6.42l19.491 3.521a7.963 7.963 0 016.42 9.252 7.963 7.963 0 01-9.251 6.42l-19.491-3.522a7.963 7.963 0 01-6.42-9.25z"
            />
          </g>
          <rect
            x="167.185"
            y="151.899"
            width="6.455"
            height="27.355"
            rx="3.227"
            ry="3.227"
            fill="#711723"
          />
          <rect
            x="207.449"
            y="151.899"
            width="6.455"
            height="27.355"
            rx="3.227"
            ry="3.227"
            fill="#711723"
          />
          <circle cx="190.083" cy="165.883" r="3.842" fill="#e76160" />
          <circle cx="190.083" cy="179.868" r="6.454" />
          <path
            fill="#f40009"
            d="M167.185 148.21h46.718v7.069h-46.718zM213.903 145.137h-46.718a10.757 10.757 0 0110.757-10.758h25.204a10.757 10.757 0 0110.757 10.758z"
          />
          <path fill="#711723" d="M167.185 143.907h46.718v4.303h-46.718z" />
          <circle cx="181.016" cy="146.059" r="7.377" fill="#711723" />
          <circle cx="181.016" cy="146.059" r="5.62" fill="#300403" />
          <circle cx="200.072" cy="146.059" r="7.377" fill="#711723" />
          <circle cx="200.072" cy="146.059" r="5.62" fill="#300403" />
          <path
            d="M176.713 165.422s2.459-3.995 6.454 0M197.306 165.422s2.459-3.995 6.454 0"
            fill="none"
            stroke="#000"
            stroke-miterlimit="10"
            stroke-width="1.844"
          />
        </g>
      </svg>
    </div>

    <div class="snowflakes">
      <script>
        for (var i = 0; i < 10; i++) {
          document.write("<div class='snowflake'>❅</div>");
        }
      </script>
    </div>

    <ul class="lightrope">
      <script>
        for (var i = 0; i < window.screen.width / 50; i++) {
          document.write("<li></li>");
        }
      </script>
    </ul>

    <div id="tree">
      <h1>Dear Ruby Tyann ~ <br> MERRY CHRISTMAS</h1>
      <div id="star"></div>
      <div id="dan1"></div>
      <div id="dan2"></div>
      <div id="trunk"></div>
    </div>

    <div class="deer-container">
      <div class="artboard">
        <div class="deer">
          <div class="rocking">
            <div class="head">
              <div class="horns">
                <div class="horn horn-left">
                  <div class="line line-one"></div>
                  <div class="line line-two"></div>
                  <div class="line line-three"></div>
                </div>
                <div class="horn horn-right">
                  <div class="line line-one"></div>
                  <div class="line line-two"></div>
                  <div class="line line-three"></div>
                </div>
              </div>
              <div class="ears">
                <div class="ear ear-left"></div>
                <div class="ear ear-right"></div>
              </div>
              <div class="eyes">
                <div class="eye eye-left"></div>
                <div class="eye eye-right"></div>
              </div>
              <div class="nose"></div>
            </div>
            <div class="body">
              <div class="shadow"></div>
              <div class="hooves">
                <div class="hoof-one">
                  <div class="line"></div>
                  <div class="anim-part">
                    <div class="circle">
                      <div class="circle">
                        <div class="circle">
                          <div class="circle">
                            <div class="circle circle-last"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="hoof-two">
                  <div class="line-one"></div>
                  <div class="line-two"></div>
                </div>
              </div>
            </div>
            <div class="tail">
              <div class="circle">
                <div class="circle">
                  <div class="circle">
                    <div class="circle">
                      <div class="circle"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="legs">
            <div class="leg-left">
              <div class="anim-part">
                <div class="line"></div>
              </div>
            </div>
            <div class="leg-right">
              <div class="anim-part">
                <div class="circle">
                  <div class="circle">
                    <div class="circle">
                      <div class="circle">
                        <div class="circle">
                          <div class="circle">
                            <div class="circle">
                              <div class="circle">
                                <div class="circle circle-last"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="presents">
          <div class="present present-one"></div>
          <div class="present present-two"></div>
          <div class="present present-two present-two-right"></div>
          <div class="present present-three"></div>
        </div>
      </div>
    </div>

    <audio autoplay="autoplay" loop="loop" preload="auto" controls="controls"
            src="sunset.mp3">       
    </audio>
    <style type="text/css">
      audio{
              display: none;
          }
     </style>

    <!-- <script src="https://threejs.org/build/three.js"></script> -->
    <script src="three.js"></script>
    <script type="module">
      function getRandom(min, max) {
        min = Math.ceil(min)
        max = Math.floor(max)
        return Math.floor(Math.random() * (max - min + 1)) + min
      }

      // import { OrbitControls } from 'https://unpkg.com/three@0.123.0/examples/jsm/controls/OrbitControls.js';
      import { OrbitControls } from './OrbitControls.js';

			const scene = new THREE.Scene()
			const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)

			const renderer = new THREE.WebGLRenderer({alpha: true})
			renderer.setSize(window.innerWidth, window.innerHeight)
			// document.body.appendChild(renderer.domElement)
      document.getElementById('pos').appendChild(renderer.domElement);

      camera.position.z = 50

      const spheres = []
      {
        for (let i = 0; i < 120; i++) {
          const geometry = new THREE.SphereGeometry(0.2, 32, 32)
          const material = new THREE.MeshBasicMaterial({ color: '#ffffff' })
          const sphere = new THREE.Mesh(geometry, material)
          sphere.downSpeed = getRandom(100, 300) / 1000
          sphere.position.y = getRandom(-5, 70)
          sphere.position.x = getRandom(-50, 50)
          sphere.position.z = getRandom(-50, 50)
          spheres.push(sphere)
          scene.add(sphere)
        }
      }

      const controls = new OrbitControls(camera, renderer.domElement)
      controls.rotateSpeed = 1.0
      controls.zoomSpeed = 1.2
      controls.panSpeed = 0.8
      controls.minDistance = 5
      controls.maxDistance = 100

      function animateStars() {
        for (let i = 0; i < 120; i++) {
          spheres[i].position.y -= spheres[i].downSpeed
          if (spheres[i].position.y < -30) spheres[i].position.y = 70
          renderer.render(scene, camera)
        }
      }

      function animate() {
        requestAnimationFrame(animate)
        renderer.render(scene, camera)
        controls.update()
        animateStars()
      }

      animate()
    </script>

    <script>
      const renderTree = () => {
        const tree = document.querySelector('#tree');
        const dan1 = document.querySelector('#dan1');
        const dan2 = document.querySelector('#dan2');

        const triWidth = 50;
        const dan1Row = Math.round((tree.clientWidth * 0.5) / triWidth / 2) + 1; // 1단 행 수
        const dan1LastTriCnt = (dan1Row - 1) * 2 + 1; // 1단 마지막행 삼각형 개수
        const dan2LastTriCnt = Math.round(tree.clientWidth / triWidth) + 1; // 2단 마지막행 삼각형 개수

        const dan1LoopObj = {
          rowStart: 0,
          rowEnd: dan1Row,
          rowIncre: 1,
          i: 0,
          triStart: 0,
          triEnd: function () {
            return this.i * 2 + 1;
          },
          triIncre: 1,
          el: dan1,
        };

        const dan2LoopObj = {
          rowStart: dan1LastTriCnt - 2,
          rowEnd: dan2LastTriCnt,
          rowIncre: 2,
          i: 0,
          triStart: 0,
          triEnd: function () {
            return this.i;
          },
          triIncre: 1,
          el: dan2,
        };

        const execLoop = obj => {
          for (let i = obj.rowStart; i < obj.rowEnd; i += obj.rowIncre) {
            const row = document.createElement('div'); // 행
            row.classList.add('row');

            obj.i = i;

            for (let j = obj.triStart; j < obj.triEnd(); j += obj.triIncre) {
              const tri = document.createElement('div'); // 삼각형
              tri.classList.add('tri');

              row.appendChild(tri);
            }

            obj.el.appendChild(row);
          }
        };

        execLoop(dan1LoopObj);
        execLoop(dan2LoopObj);
      };

      const getRandomColor = () => {
        const h = Math.floor(Math.random() * (160 - 100)) + 100; // green
        const s = Math.floor(Math.random() * (80 - 30)) + 30;
        const v = Math.floor(Math.random() * (80 - 30)) + 30;
        const hsl = `hsl(${h}deg ${s}% ${v}%)`;
        return hsl;
      };

      const changeColor = () => {
        const triList = document.querySelectorAll('.tri');
        triList.forEach(item => {
          item.style.borderBottomColor = getRandomColor();
        });
      };

      renderTree();
      setInterval(changeColor, 1000);
    </script>
  </body>
</html>
